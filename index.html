<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <title>港式台牌計分面板</title>
    <link rel="manifest" href="manifest.webmanifest">
</head>
<body>
<<<<<<< HEAD

    <!-- Initial settings -->
<div id="global">
    <div class="container-fluid" id="initial">
        <div id="setting-diag">
            <div class="title">請輸入玩家名稱</div>
            <div>
                <label for="name_east">東位：</label>
                <input type="text" name="name_east" id="name_east"></input>
            </div>
            <div>
                <label for="name_south">南位：</label>
                <input type="text" name="name_south" id="name_south"></input>
            </div>
            <div>
                <label for="name_west">西位：</label>
                <input type="text" name="name_west" id="name_west"></input>
            </div>
            <div>
                <label for="name_north">北位：</label>
                <input type="text" name="name_north" id="name_north"></input>
            </div>
            <div class="row mt-1 select_pan">
                <div class="col-3">字體：</div>
                <a class="col-3 button select active" href="javascript:setfont('');">預設</a>
                <a class="col-3 button select" href="javascript:setfont('Noto Serif TC, serif');" style="font-family: Noto Serif TC, serif">思源宋體</a>
                <a class="col-3 button select" href="javascript:setfont('Noto Sans TC, sans-serif');" style="font-family: Noto Sans TC, sans-serif">思源黑體</a>
            </div>
            <a class="button col mt-1" href="javascript:void(0);" style="width: 100%" data-toggle="modal" data-target="#option"><i class="fas fa-cogs mr-2"></i>選項</a>
            <a class="button mt-1" href="javascript:void(0);" style="width: 100%" data-toggle="modal" data-target="#about"><i class="fas fa-heart mr-2"></i></i>關於</a>
            <a class="button button-big mt-1" href="javascript:initiate();"><i class="fas fa-gamepad mr-2"></i>開始</a>
        </div>
        <div style="position: absolute; bottom: 0px; right: 0px;">v1.10</div>
    </div>
    <!-- Main screen -->
    <div class="container-fluid" id="main">
        <div class="row">
            <div class="col" id="main_left">
                <div class="row">
                    <div class="title col-4" id="time"></div>
                    <div class="title col-8" id="turn"></div>
                </div>
                <div id="table_wrap">
                    <div id="table">
                        <div class="corner" id="left-upper_corner"></div>
                        <div class="hori-block text-block" id="N-text"></div>
                        <div class="corner" id="right-upper_corner"></div>
                        <div class="corner" id="left-upper_div"></div>
                        <div class="hori-block" id="north"><div class="streak"></div><i class="fas fa-exclamation-circle none" data-toggle="modal" data-target="#break"></i></div>
                        <div class="corner" id="right-upper_div"></div>
                        <div class="vert-block text-block" id="E-text"></div>
                        <div class="vert-block" id="east"><div class="streak"></div><i class="fas fa-exclamation-circle none" data-toggle="modal" data-target="#break"></i></div>
                        <div id="center"><i class="fas fa-balance-scale-left none" data-toggle="tooltip" data-placement="top" title="番數曾經被手動調整；請參考記錄" style="font-size: 5vh; align-self: center"></i></div>
                        <div class="vert-block" id="west"><div class="streak"></div><i class="fas fa-exclamation-circle none" data-toggle="modal" data-target="#break"></i></div>
                        <div class="vert-block text-block" id="W-text"></div>
                        <div class="corner" id="left-lower_div"></div>
                        <div class="hori-block" id="south"><div class="streak"></div><i class="fas fa-exclamation-circle none" data-toggle="modal" data-target="#break"></i></div>
                        <div class="corner" id="right-lower_div"></div>
                        <div class="corner" id="left-lower_corner"></div>
                        <div class="hori-block text-block" id="S-text"></div>
                        <div class="corner" id="right-lower_corner"></div>
                    </div>
                </div>
                <div>
                    <div class="row mt-2">
                        <a class="col button button-medium ml-2 mr-1" href="javascript:void(0);" data-toggle="modal" data-target="#instant"><i class="fas fa-bolt mr-2"></i>即收・即付</a>
                        <a class="col button button-medium mr-2 ml-1" href="javascript:void(0);" data-toggle="modal" data-target="#ron"><i class="fas fa-crown mr-2"></i>食糊・流局</a>
                    </div>
                    <div class="row mt-2">
                        <a class="col button button-medium ml-2 mr-1" data-toggle="modal" data-target="#settle" href="javascript:void(0);"><i class="fas fa-calculator mr-2"></i>結算・調整</a>
                        <a class="col button button-medium mr-2 ml-1" href="javascript:void(0);" data-toggle="modal" data-target="#end"><i class="far fa-check-circle mr-2"></i>結束</a>
                    </div>
                </div>
            </div>
            <div class="col" id="main_right">
                <div id="rightbuttongroup">
                    <span class="mt-1 mr-2">
                    <a href="javascript:void(0);" class="inactive" data-toggle="tooltip" data-placement="bottom" title="按一下切換數值顯示為番或錢"><i class="fas fa-list-ul mr-1"></i>番</a>
                    </span>
                    <span class="mt-1 mr-2">
                    <a id="undo" href="javascript:undo();" data-toggle="tooltip" data-placement="bottom" title="按一下取消上一次數值更變"><i class="fas fa-undo mr-1"></i>還原</a>
                    </span>
                    <span class="mt-1 mr-2">
                    <a id="redo" href="javascript:redo();" data-toggle="tooltip" data-placement="bottom" title="按一下重做上一次數值更變"><i class="fas fa-redo mr-1"></i>重做</a>
                    </span>
                    <span class="mt-1 mr-2" data-toggle="modal" data-target="#log">
                    <a href="javascript:void(0);" data-toggle="tooltip" data-placement="bottom" title="顯示游戲的記錄"><i class="far fa-clipboard mr-1"></i>記錄</a>
                    </span>
                    <span class="mt-1 mr-2" data-toggle="modal" data-target="#option">
                    <a href="javascript:void(0);" data-toggle="tooltip" data-placement="bottom" title="選項包括更變主題、儲存及載入進度"><i class="fas fa-cogs mr-1"></i>選項</a>
                    </span>
                    <span class="mt-1" data-toggle="modal" data-target="#about">
                    <a href="javascript:void(0);" data-toggle="tooltip" data-placement="bottom" title="有關本網頁及助養作者"><i class="fas fa-heart mr-1"></i>關於</a>
                    </span>
                </div>
                <div id="record" class="mt-2">
                    <table>
                        <tr id="record_add">
                            <th class="first_row">#</th>
                            <th class="other_row p1name"></th>
                            <th class="other_row p2name"></th>
                            <th class="other_row p3name"></th>
                            <th class="other_row p4name"></th>
                        </tr>
                    </table>
                </div>
                <div id="stat_view" class="mt-3">
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="game_stat_view">
                            <div class="row" style="width: 95%">
                                <div class="col">
                                    <table style="width: 100%">
                                        <tr>
                                            <th style="width: 50%; border-bottom: 0.5vh solid var(--highlight);">項目</th>
                                            <th style="width: 50%; border-bottom: 0.5vh solid var(--highlight);">數值</th>
                                        </tr>
                                        <tr id="stat_get">
                                            <td>即收總和</td>
                                            <td></td>
                                        </tr>
                                        <tr id="stat_pay">
                                            <td>即付總和</td>
                                            <td></td>
                                        </tr>
                                        <tr id="stat_avg_yaku">
                                            <td>平均食糊番數</td>
                                            <td></td>
                                        </tr>
                                        <tr id="stat_total_change">
                                            <td>總番數流動</td>
                                            <td></td>
                                        </tr>
                                        <tr id="game_max_yaku">
                                            <td>最大食糊番數</td>
                                            <td></td>
                                        </tr>
                                        <tr id="game_max_streak">
                                            <td>最大連莊</td>
                                            <td></td>
                                        <tr>
                                    </table>
                                </div>
                                <div class="col">
                                    <table style="width: 100%">
                                        <tr>
                                            <th style="width: 33%; border-bottom: 0.5vh solid var(--highlight);">統計</th>
                                            <th style="width: 33%; border-bottom: 0.5vh solid var(--highlight);">總數</th>
                                            <th style="width: 33%; border-bottom: 0.5vh solid var(--highlight);">比例</th>
                                        </tr>
                                        <tr id="stat_draw">
                                            <td>流局</td>
                                            <td>0</td>
                                            <td>0%</td>
                                        </tr>
                                        <tr id="stat_deal">
                                            <td>出銃</td>
                                            <td>0</td>
                                            <td>0%</td>
                                        </tr>
                                        <tr id="stat_tsumo">
                                            <td>自摸</td>
                                            <td>0</td>
                                            <td>0%</td>
                                        </tr>
                                        <tr id="stat_round">
                                            <td>總局數</td>
                                            <td>0</td>
                                            <td>100%</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="player_stat_view">
                            <table style="width: 95%">
                                <tr>
                                    <th style="width: 20%; border-bottom: 0.5vh solid var(--highlight);">項目</th>
                                    <th style="width: 20%" colspan="2" class="p1name"></th>
                                    <th style="width: 20%" colspan="2" class="p2name"></th>
                                    <th style="width: 20%" colspan="2" class="p3name"></th>
                                    <th style="width: 20%" colspan="2" class="p4name"></th>
                                </tr>
                                <tr id="player_win">
                                    <td>勝<td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                </tr>
                                <tr id="player_lose">
                                    <td>負<td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                </tr>
                                <tr id="player_tsumo">
                                    <td>自摸</td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                </tr>
                                <tr id="player_deal">
                                    <td>出銃<td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                </tr>
                                <tr id="player_instantget">
                                    <td>即收</td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                </tr>
                                <tr id="player_instantpay">
                                    <td>即付</td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                    <td></td><td></td>
                                </tr>
                                <tr id="player_max_yaku">
                                    <td>最大番數</td>
                                    <td colspan="2"></td>
                                    <td colspan="2"></td>
                                    <td colspan="2"></td>
                                    <td colspan="2"></td>
                                </tr>
                                <tr id="player_max_streak">
                                    <td>最大連莊</td>
                                    <td colspan="2"></td>
                                    <td colspan="2"></td>
                                    <td colspan="2"></td>
                                    <td colspan="2"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="tab-pane fade" id="graph_view">
                        </div>
                    </div>
                </div>
                <div id="stat_nav">
                    <ul class="nav nav-pills" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link nav-stat active" data-toggle="pill" href="#game_stat_view">游戲數據</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-stat" data-toggle="pill" href="#player_stat_view">玩家數據</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-stat" data-toggle="pill" href="#graph_view">趨勢(已結算)</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col none" id="footer_context" style="justify-content: center;">
                <div class="row align-items-center justify-content-center" style="text-align: center; height: 92vh">
                    <div class="col-6">
                        <a href="javascript:void(0)">
                            <div><i class="fas fa-undo mr-3"></i>還原</div>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="javascript:void(0)">
                            <div><i class="fas fa-redo mr-3"></i>重做</div>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="javascript:void(0)">
                            <div data-toggle="modal" data-target="#log"><i class="fas fa-clipboard mr-3"></i>紀錄</div>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="javascript:void(0)">
                            <div data-toggle="modal" data-target="#option"><i class="fas fa-cogs mr-3"></i>選項</div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="footer_menu">
        <div class="row align-items-center" style="height:100%">
            <div class="col highlight footer_select">
                <a href="javascript:void(0)">
                    <div>
                        <i class="fas fa-border-all"></i><br>主頁
                    </div>
                </a>
            </div>
            <div class="col footer_select">
                <a href="javascript:void(0)">
                    <div>
                        <i class="far fa-chart-bar"></i><br>數據
                    </div>
                </a>
            </div>
            <div class="col footer_select">
                <a href="javascript:void(0)">
                    <div>
                        <i class="fas fa-ellipsis-v"></i><br>其他
                    </div>
                </a>
            </div>
        </div>
    </div>
    <!--Context Menu-->
    <div class="list-group none" id="context">
        <li class="list-group-item list-group-item-action" id="context_name" style="font-weight: bold"><div class="context_wrap"></div></li>
        <a class="list-group-item list-group-item-action" id="context_instantget"><div class="context_wrap">即收</div></a>
        <a class="list-group-item list-group-item-action" id="context_instantpay"><div class="context_wrap">即付</div></a>
        <a class="list-group-item list-group-item-action" id="context_deal"><div class="context_wrap">出統</div></a>
        <a class="list-group-item list-group-item-action" id="context_tsumo"><div class="context_wrap">自摸</div></a>
    </div>
    <!-- Modals -->
    <!-- About modal -->
    <div class="modal" id="about">
        <div class="modal-dialog modal-diaglog-centered modal-lg modal-diaglog-scrollable">
            <div class="modal-content">
                <div class="modal-header title">
                    <div class="nav nav-pills" role="tablist">
                        <ul class="nav nav-pills" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link nav-custom active" data-toggle="pill" href="#license">授權</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link nav-custom" data-toggle="pill" href="#about_tech">關於</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link nav-custom" data-toggle="pill" href="#support">支持</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="tab-content">
                        <div class="tab-pane show active" id="license">
                            <p>港式台牌計分面板</p>
                            <p>Copyright (C) 2021  Rippka</p>

                            <p class=mt-2>This program is free software: you can redistribute it and/or modify
                            it under the terms of the GNU General Public License as published by
                            the Free Software Foundation, either version 3 of the License, or
                            (at your option) any later version.</p>

                            <p class=mt-2>This program is distributed in the hope that it will be useful,
                            but WITHOUT ANY WARRANTY; without even the implied warranty of
                            MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                            GNU General Public License for more details.</p>

                            <p class=mt-2>You should have received a copy of the GNU General Public License
                            along with this program.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>
                        </div>
                        <div class="tab-pane" id="about_tech">
                            <p>本站使用以下函式庫或字型：</a>
                                <ul>
                                    <li>Bootstrap 4.6.0 (MIT)</li>
                                    <li>JQuery 3.5.1 (MIT)</li>
                                    <li>Plotly (MIT)</li>
                                    <li>Font Awesome (MIT, Sil OFL)</li>
                                    <li>Noto Fonts (Sil OFL)</li>
                                </ul>
                        </div>
                        <div class="tab-pane" id="support">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Option modal -->
    <div class="modal" id="option">
        <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header title">
                    <ul class="nav nav-pills" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link nav-custom active" data-toggle="pill" href="#game_setting">游戲設置</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-custom" data-toggle="pill" href="#theme_setting">外觀設置</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-custom" data-toggle="pill" href="#io">匯入/匯出</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-custom" data-toggle="pill" href="#clear">清除暫存</a>
                        </li>
                    </ul>
                </div>
                <div class="modal-body">
                    <div class="tab-content">
                        <div class="tab-pane show active" id="game_setting">
                            <div class="row">
                                <div class="col-6 gs_left"><i class="fas fa-info-circle" title="所有玩家的初始番數&#13;&#10;預設為 0"></i> 底：</div>
                                <div class="col-6 gs_right"><input id="option_base" class="positiveintonly" type="number"></input></div>
                                <div class="col-6 gs_left"><i class="fas fa-info-circle" title="每一番代表多少錢&#13;&#10;預設為 1"></i> x元一番：</div>
                                <div class="col-6 gs_right"><input id="option_money" class="numonly" type="number"></input></div>
                                <div class="col-6 gs_left"><i class="fas fa-info-circle" title="拉的時侯番數的倍數&#13;&#10;例：設倍數為1.5。第一局，甲勝乙100番。如甲於第二局再勝乙時，甲於第一局所贏的番數會變成150番。&#13;&#10;預設為 1.5，必須大於 1"></i> 拉倍數：</div>
                                <div class="col-6 gs_right"><input id="option_fold" class="numonly" type="number"></input></div>
                                <div class="col-6 gs_left"><i class="fas fa-info-circle" title="當連續輸給某一玩家x局，輸的玩家可選擇中止拉踢&#13;&#10;預設為 3&#13;&#10;0 代表無限拉"></i> 每x局數可中止拉踢：</div>
                                <div class="col-6 gs_right"><input id="option_break" class="positiveintonly" type="number"></input></div>
                                <div class="center_button_container col mt-2">
                                    <a class="button" href="javascript:get_game_setting()">保存</a>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="theme_setting">
                            <div class="row" style="justify-content: center">
                                <div class="col-4 gs_left">主題</div>
                                <div class="col-8 gs_right"><select id="theme_select">
                                    <option value="Nord">北歐</option>
                                    <option value="Nord_alt">冷色系北歐</option>
                                    <option value="Dracula">德古拉</option>
                                    <option value="Gruvbox_light">亮色航空</option>
                                    <option value="Gruvbox_dark">暗色航空</option>
                                    <option value="High_contrast">高對比</option>
                                </select></div>
                                <div class="mt-1 col-4 gs_left">字體</div>
                                <div class="mt-1 col-8 gs_right select_pan">
                                    <a class="button select active" href="javascript:setfont('');">預設</a>
                                    <a class="button select" href="javascript:setfont('Noto Serif TC, serif');" style="font-family: Noto Serif TC, serif">思源宋體</a>
                                    <a class="button select" href="javascript:setfont('Noto Sans TC, sans-serif');" style="font-family: Noto Sans TC, sans-serif">思源黑體</a>
                                </div>
                                <div class="col-8 mt-2" style="text-align:center;"><input type="checkbox" id="fullscreen"></input><label for="fullscreen" class="ml-1">開始時自動進入全屏幕</label></div>
                                <div class="col-4 mt-2" style="text-align:center;"><a class="button" href="javascript:fullscreen();">全屏幕</a></div>
                            </div>
                        </div>
                        <div class="tab-pane" id="io">
                            <div class="row mr-1 ml-1">
                                <div class="col-4">匯出：</div>
                                <div class="col-8" style="display: flex; justify-content: flex-end;"><a class="button mr-2" style="width: 12vw" id="download">另儲為JSON檔</a><a class="button" style="width: 12vw" id="clipboard" href="javascript:void(0);">複制到剪貼簿</a></div>
                                <div class="col-12 mt-2"><textarea id="export" readonly></textarea></div>
                                <div class="col-12 mt-3">匯入：</div>
                                <div class="col-12 mt-2"><textarea id="import"></textarea></div>
                                <div class="col-12 mt-1" id="import_error_msg"></div>
                                <div class="center_button_container col mt-2">
                                    <a class="button" id="import_button" href="javascript:void(0);">匯入並開始</a>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="clear">
                            <div class="mt-2" style="font-size:clamp(15px, 4vh, 45px);"><i class="fas fa-exclamation-triangle"></i>清理暫存會影響現時設置及遊戲</div>
                            <div class="row select_pan mt-2">
                                <a class="button select col" href="javascript:void(0);">清除所有暫存</a>
                                <a class="button select col" href="javascript:void(0);">只清除本局遊戲暫存</a>
                                <a class="button select col" href="javascript:void(0);">只清除設置暫存</a>
                            </div>
                            <div class="center_button_container mt-2"><a class="button" href="javascript:void(0);">確定</a></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Instant pay or get modal -->
    <div class="modal" id="instant">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <ul class="nav nav-pills" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link nav-custom active" data-toggle="pill" href="#instantget">即收</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-custom" data-toggle="pill" href="#instantpay">即付</a>
                        </li>
                    </ul>
                </div>
                <div class="modal-body">
                    <div class="tab-content">
                        <div class="tab-pane show active" id="instantget">
                            <div class="mt-2">請選擇即收者：
                                <div class="player_select row select_pan">
                                    <a class="p1box col" href="javascript:void(0);"></a>
                                    <a class="p2box col" href="javascript:void(0);"></a>
                                    <a class="p3box col" href="javascript:void(0);"></a>
                                    <a class="p4box col" href="javascript:void(0);"></a>
                                </div>
                            </div>
                            <div class="mt-2">
                                <label>即收數目：</label>
                                <div class="select_pan row">
                                    <a class="button select col-4" href="javascript:void(0);">3</a>
                                    <a class="button select col-4" href="javascript:void(0);">5</a>
                                    <a class="button select col-4" href="javascript:void(0);">8</a>
                                    <a class="button select col" href="javascript:void(0);">其他：<input type="number" class="others ml-2 positiveintonly" id="instantget_others"></input></a>
                                </div>
                            </div>
                            <div class="mt-2 center_button_container none">
                                <a class="button" href="javascript:instant('get');">確定</a>
                            </div>
                        </div>
                        <div class="tab-pane" id="instantpay">
                            <div class="mt-2">請選擇即付者：
                                <div class="player_select row select_pan">
                                    <a class="p1box col" href="javascript:void(0);"></a>
                                    <a class="p2box col" href="javascript:void(0);"></a>
                                    <a class="p3box col" href="javascript:void(0);"></a>
                                    <a class="p4box col" href="javascript:void(0);"></a>
                                </div>
                            </div>
                            <div class="mt-2">
                                <label>即付數目：</label>
                                <div class="select_pan row">
                                    <a class="button select col-6" href="javascript:void(0);">5</a>
                                    <a class="button select col-6" href="javascript:void(0);">10</a>
                                    <a class="button select col" href="javascript:void(0);">其他：<input type="number" class="others ml-2 positiveintonly" id="instantpay_others"></input></a>
                                </div>
                                </select>
                            </div>
                            <div class="mt-2 center_button_container none">
                                <a class="button" href="javascript:instant('pay');">確定</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
=======
<div id="container">
        <div id="loading_squares">
            <div id="loading_square_bg"></div>
            <div id="loading_square_fg"></div>
>>>>>>> Nightly
        </div>
        <div id="loading_text" style="font-size: 1rem;"></div>
        <noscript><div>Please enable javascript to continue.</div></noscript>
</div>
</body>
<style>
:root {
    --p1-color: #d08770;
    --p2-color: #ebcb8b;
    --p3-color: #a3be8c;
    --p4-color: #b48ead;
    --bg-nord: #2e3440;
    --fg-nord: #e5e9f0;
    --highlight: #81a1c1;
}
body{
    margin: 0px;
    font-family: 'Courier New', monospace;
}
#container{
    display: flex;
    background-color: var(--bg-nord);
    height: 100vh;
    width: 100vw;
    top: 0px;
    left: 0px;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
#loading_squares{
    position: relative;
    height: clamp(80px, 15vh, 15vw);
    width: clamp(80px, 15vh, 15vw);
    background-color: var(--highlight);
}
#loading_square_bg{
   position: absolute;
   width: 100%;
   height: 100%;
   top: 0px;
   left: 0px;
   z-index: 1;
   animation-name: loading_bg;
   animation-timing-function: linear;
   animation-duration: 2.5s;
   animation-iteration-count: infinite;
}
#loading_square_fg{
   position: absolute;
   width: 100%;
   height:100%;
   top: 0px;
   left: 0px;
   z-index: 2;
   animation-name: loading_fg;
   animation-timing-function: linear;
   animation-duration: 2.5s;
   animation-iteration-count: infinite;
}
#loading_text{
    text-align: center;
    color: var(--fg-nord);
    margin-top: 1em;
}
@keyframes loading_fg{
   0% {background-color: var(--p1-color); top: 0%; left: 0%; height: 100%; width: 0px}
   20% {background-color: var(--p1-color); height: 100%; width: 100%}
   20.5% {display: none; top: 0%; left: 0%; height: 0%; width: 100%}
   25% {background-color: var(--p2-color); display: block;}
   45% {background-color: var(--p2-color); top: 0%; left: 0%; height: 100%; width:100%;}
   45.5% {display: none; top: 0%; left: 100%; height: 100%; width: 0px; }
   50% {background-color: var(--p3-color); display: block;}
   70% {background-color: var(--p3-color); top: 0%; left: 0%; height: 100%; width:100%;}
   70.5% {display: none; top: 100%; left: 0%; height: 0%; width: 100%}
   75% {background-color: var(--p4-color); display: block;}
   95% {background-color: var(--p4-color); top: 0%; left: 0%; height: 100%; width: 100%}
   95.5% {display: none; top: 0%; left: 0%; height: 0%; width: 0%}
   100% {display: none;}
}

@keyframes loading_bg{
   0% {background-color: var(--p4-color);}
   20% {background-color: var(--p4-color);}
   20.1% {background-color: var(--p1-color);}
   45% {background-color: var(--p1-color);}
   45.1% {background-color: var(--p2-color);}
   70% {background-color: var(--p2-color);}
   70.1% {background-color: var(--p3-color);}
   95% {background-color: var(--p3-color);}
   95.1% {background-color: var(--p4-color);}
   100% {background-color: var(--p4-color);}
}
button{
    font-family: 'Courier New', monospace;
}
</style>
<script>
const broadcast = new BroadcastChannel('msg-channel'); //Create broadcast channel
let loading_text=document.getElementById('loading_text');
broadcast.onmessage = event => {
    loading_text.innerHTML=event.data; //Show broadcast message from service worker
}
function redirect(){
    setTimeout(function(){window.location.replace('main.html')}, 500);
}
async function register_sw(){
    if ('serviceWorker' in navigator){
        try{
            let sw_status = await navigator.serviceWorker.register('sw.js'); //Try register service worker
        } catch (err){
            loading_text.innerHTML='Error: ' + err + '<br>Redirecting without service worker.';
            redirect(); //Redirect if any error
        }
    } else {
        loading_text.innerHTML='Browser do not support service worker, redirecting...'
        redirect(); //Redirect if not supported
    }
}
register_sw()
navigator.serviceWorker.ready.then(()=>{
    console.log('Service Worker ready!');
    loading_text.innerHTML='Service Worker Ready!!'
    redirect(); //Redirect when ready
});
</script>
